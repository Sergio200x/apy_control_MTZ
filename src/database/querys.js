

export const querys ={
   
    equipos_prp:`use ${process.env.DB_NAME_PRP}  select  LTRIM(RTRIM(v.local)) as 'Codigolocal',  IIF(v.PARAMETRO='VERSION','Profit',v.parametro) as 'Aplicacion',    rtrim(ltrim(v.valor)) as 'Nversion',  MAX(v.FECHATRANS) as 'FechaAct',   RTRIM(LTRIM(v.EQUIPO))AS EQUIPO  ,   RTRIM(LTRIM(v.caja))AS Caja  from hparamloc AS V   where v.PARAMETRO like 'version'   and v.FECHATRANS > getdate()-1  GROUP BY v.empresa, v.local, v.parametro, v.valor,v.EQUIPO,v.caja order by v.local ,V.EQUIPO`,
    versiones_prp:`use ${process.env.DB_NAME_PRP} select LTRIM(RTRIM(hpl.local)) as 'Codigo_Local',rtrim(ltrim(substring(loc.local_nombre,0,20))) as 'Nombre_local', case when rtrim(ltrim(hpl.PARAMETRO))='Version' then 'Profit' when rtrim(ltrim(hpl.PARAMETRO))='Informes|Version' then 'Informes'  when rtrim(ltrim(hpl.PARAMETRO))='PanelRappi|VERSION' then 'Rappi' when rtrim(ltrim(hpl.PARAMETRO))='PanelPedidosYa|VERSION' then 'Peya' when rtrim(ltrim(hpl.PARAMETRO))='PanelMTZ|VERSION' then 'AppMtz'   when rtrim(ltrim(hpl.PARAMETRO))='ActualizaDatos|VERSION' then 'Actualizadatos'  when rtrim(ltrim(hpl.PARAMETRO))='Centralizador' then 'Centralizador'  when rtrim(ltrim(hpl.PARAMETRO))='CentralizadorComanda|Version' then 'CentralizadorComanda'  when rtrim(ltrim(hpl.PARAMETRO))='PanelMELI|VERSION' then 'Meli' when rtrim(ltrim(hpl.PARAMETRO))='DescargaLocal|VERSION' then 'DescargaLocal'  when rtrim(ltrim(hpl.PARAMETRO))='ZonaEntrega|Version' then 'DualpointCaja'   when rtrim(ltrim(hpl.PARAMETRO))='ZonaLlamador|Version' then 'Dualpointllamador'  when rtrim(ltrim(hpl.PARAMETRO))='PantallaComanda|Version' then 'PantallaComanda'   when rtrim(ltrim(hpl.PARAMETRO))='CFOCXVERSI' then 'OCX'  when rtrim(ltrim(hpl.PARAMETRO))='VERSIONT' then 'totem.exe' when rtrim(ltrim(hpl.PARAMETRO))='Informes' then 'Informes' when rtrim(ltrim(hpl.PARAMETRO))='ActiveX|Version' then 'DLL MercadoPago' when rtrim(ltrim(hpl.PARAMETRO))='TOTEM_VERSION' then 'Totem Version' end as 'Parametro',  rtrim(ltrim(replace(replace(hpl.valor,'.:: v',''),'::.',''))) as 'Nro_version',MAX( substring(convert(varchar,hpl.FECHATRANS,103),0,15)) as 'FechaTrans',RTRIM(LTRIM(substring(hpl.EQUIPO,0,15)))AS EQUIPO  ,RTRIM(LTRIM(hpl.caja))AS Caja from  (select *, ROW_NUMBER() OVER ( PARTITION BY equipo, parametro, local    ORDER BY fechatrans DESC)   rango from hparamloc where parametro in('Informes|Version','PanelRappi|VERSION','PanelPedidosYa|VERSION','PanelMTZ|VERSION','ActualizaDatos|VERSION','Centralizador','CentralizadorComanda|Version','VERSION','PanelMELI|VERSION','DescargaLocal|VERSION','ZonaEntrega|Version','ZonaLlamador|Version','PantallaComanda|Version','CFOCXVERSI','VERSIONT','ActiveX|Version','TOTEM_VERSION') and local not in ('pru','test','') and FECHATRANS > getdate()-10 )as hpl left join locales loc on loc.local_codigo = hpl.local collate SQL_Latin1_General_CP1_CI_AS where rango = 1 and hpl.parametro = '@parametro2' and hpl.fechatrans>getdate()-10 group by hpl.LOCAL,loc.local_nombre,hpl.PARAMETRO, hpl.valor ,hpl.FECHATRANS , hpl.EQUIPO,hpl.caja order by hpl.LOCAL desc`,
    preciosyarts:`use ${process.env.DB_NAME_PRP} select TIPO='PROPIO',rtrim(ltrim(ISNULL(substring(l.local_nombre,0,20),'VACIO'))) AS 'NOMBRE_DE_LOCAL', rtrim(ltrim(ISNULL(p.LISP_CODIGO,'VACIO'))) AS 'CODIGO_DE_LOCAL',rtrim(ltrim(ISNULL(p.ART_CODIGO,'VACIO'))) AS 'CODIGO_DE_ARTICULO',rtrim(ltrim(ISNULL(a.ART_DESCORTA,'VACIO'))) AS 'DESC_CORTA',rtrim(ltrim(ISNULL(a.ART_DESLARGA,'VACIO'))) AS 'DESC_LARGA',rtrim(ltrim(ISNULL(p.PRE_PRECIO,'VACIO'))) AS 'PRECIO',rtrim(ltrim(isnull(p.PRE_PRECIOUNIDAD,'VACIO'))) AS 'PRECIO_UNI',rtrim(ltrim(ISNULL(converT(varchar,p.PRE_FECCAM,3),'VACIO'))) AS 'ULTIMO_ENV',rtrim(ltrim(ISNULL(convert(varchar,p.dfecha_desde,3),'VACIO'))) AS 'DESDE',rtrim(ltrim(ISNULL(convert(varchar,p.dfecha_hasta,3),'VACIO'))) AS 'HASTA',rtrim(ltrim(ISNULL(a.ART_PADRE,'VACIO'))) AS 'RUBRO',rtrim(ltrim(ISNULL(a.tpr_codigo,'VACIO'))) AS 'ES_MENU' ,rtrim(ltrim(ISNULL(a.ART_ACTIVO,'VACIO'))) AS 'ACTIVO',rtrim(ltrim(ISNULL(a.art_comanda,'VACIO'))) AS 'SE_AGRANDA',rtrim(ltrim(ISNULL(a.ART_FACTURABLE,'VACIO'))) AS 'SE_FACTURA',rtrim(ltrim(ISNULL(a.ART_SEVENDE,'VACIO'))) AS 'SE_VENDE',rtrim(ltrim(isnull(a.ART_CALIDAD,'VACIO'))) AS 'SE_ENVIA_A_LOCAL',rtrim(ltrim(ISNULL(a.ART_ENMENU,'VACIO'))) AS 'EN_BOTONERA',rtrim(ltrim(ISNULL(a.ART_comanda,'VACIO'))) AS Marcha,rtrim(ltrim(ISNULL(a.ART_PMSOLO,'VACIO'))) AS 'JERARQUIA_EN_ZONA' from mostaza_erp.dbo.precios p inner join MOSTAZA_ERP.dbo.locales l on l.local_codigo=p.lisp_codigo inner join MOSTAZA_ERP.dbo.articulos_E a on a.art_codigo=p.ART_CODIGO where a.art_descorta like '%@parametro%' and p.LISP_CODIGO like '%@parametro1%'`,
    locales_not_sync:`use ${process.env.DB_EMPRENAME} select sCod_Local as 'Codigo_de_local', ('AR'+'   '+[Nombre_local]) AS 'Nombre_local'  ,horas  from ( select sCod_Local,DATEDIFF(hour,dFecha_Actividad,GETDATE()) horas, m.local_nombre as [Nombre_local]  from Transfer_UDL AS T     left JOIN ${process.env.DB_NAME_PRP}.dbo.LOCALES AS M ON M.local_codigo=T.sCod_Local collate SQL_Latin1_General_CP1_CI_AS    where sCod_Local not in ('FLF2','FMLAN_O','PEÃ‘','FCSJ3_','MSA','M3F','PRU','')  and DATEDIFF(hour,dFecha_Actividad,GETDATE())>6 AND DATEDIFF(hour,dFecha_Actividad,GETDATE())<150) tabla`,
    equipos_frq:`use ${process.env.DB_NAME_FRQ}  select  LTRIM(RTRIM(v.local)) as 'Codigolocal',  IIF(v.PARAMETRO='VERSION','Profit',v.parametro) as 'Aplicacion',    rtrim(ltrim(v.valor)) as 'Nversion',  MAX(v.FECHATRANS) as 'FechaAct',   RTRIM(LTRIM(v.EQUIPO))AS EQUIPO  ,   RTRIM(LTRIM(v.caja))AS Caja  from hparamloc AS V   where v.PARAMETRO like 'version'   and v.FECHATRANS > getdate()-1  GROUP BY v.empresa, v.local, v.parametro, v.valor,v.EQUIPO,v.caja order by v.local ,V.EQUIPO`,
    versiones_frq:`use ${process.env.DB_NAME_FRQ} select LTRIM(RTRIM(hpl.local)) as 'Codigo_Local',rtrim(ltrim(substring(loc.local_nombre,0,20))) as 'Nombre_local', case when rtrim(ltrim(hpl.PARAMETRO))='Version' then 'Profit' when rtrim(ltrim(hpl.PARAMETRO))='Informes|Version' then 'Informes'  when rtrim(ltrim(hpl.PARAMETRO))='PanelRappi|VERSION' then 'Rappi' when rtrim(ltrim(hpl.PARAMETRO))='PanelPedidosYa|VERSION' then 'Peya' when rtrim(ltrim(hpl.PARAMETRO))='PanelMTZ|VERSION' then 'AppMtz'   when rtrim(ltrim(hpl.PARAMETRO))='ActualizaDatos|VERSION' then 'Actualizadatos'  when rtrim(ltrim(hpl.PARAMETRO))='Centralizador' then 'Centralizador'  when rtrim(ltrim(hpl.PARAMETRO))='CentralizadorComanda|Version' then 'CentralizadorComanda'  when rtrim(ltrim(hpl.PARAMETRO))='PanelMELI|VERSION' then 'Meli' when rtrim(ltrim(hpl.PARAMETRO))='DescargaLocal|VERSION' then 'DescargaLocal'  when rtrim(ltrim(hpl.PARAMETRO))='ZonaEntrega|Version' then 'DualpointCaja'   when rtrim(ltrim(hpl.PARAMETRO))='ZonaLlamador|Version' then 'Dualpointllamador'  when rtrim(ltrim(hpl.PARAMETRO))='PantallaComanda|Version' then 'PantallaComanda'   when rtrim(ltrim(hpl.PARAMETRO))='CFOCXVERSI' then 'OCX'  when rtrim(ltrim(hpl.PARAMETRO))='VERSIONT' then 'totem.exe' when rtrim(ltrim(hpl.PARAMETRO))='Informes' then 'Informes' when rtrim(ltrim(hpl.PARAMETRO))='ActiveX|Version' then 'DLL MercadoPago' when rtrim(ltrim(hpl.PARAMETRO))='TOTEM_VERSION' then 'Totem Version' end as 'Parametro',  rtrim(ltrim(replace(replace(hpl.valor,'.:: v',''),'::.',''))) as 'Nro_version',MAX( substring(convert(varchar,hpl.FECHATRANS,103),0,15)) as 'FechaTrans',RTRIM(LTRIM(substring(hpl.EQUIPO,0,15)))AS EQUIPO  ,RTRIM(LTRIM(hpl.caja))AS Caja from  (select *, ROW_NUMBER() OVER ( PARTITION BY equipo, parametro, local    ORDER BY fechatrans DESC)   rango from hparamloc where parametro in('Informes|Version','PanelRappi|VERSION','PanelPedidosYa|VERSION','PanelMTZ|VERSION','ActualizaDatos|VERSION','Centralizador','CentralizadorComanda|Version','VERSION','PanelMELI|VERSION','DescargaLocal|VERSION','ZonaEntrega|Version','ZonaLlamador|Version','PantallaComanda|Version','CFOCXVERSI','VERSIONT','ActiveX|Version','TOTEM_VERSION') and local not in ('pru','test','') and FECHATRANS > getdate()-10 )as hpl left join locales loc on loc.local_codigo = hpl.local collate SQL_Latin1_General_CP1_CI_AS where rango = 1 and hpl.parametro = '@parametro2' and hpl.fechatrans>getdate()-10 group by hpl.LOCAL,loc.local_nombre,hpl.PARAMETRO, hpl.valor ,hpl.FECHATRANS , hpl.EQUIPO,hpl.caja order by hpl.LOCAL desc`,
    preciosyarts_frq:`use ${process.env.DB_NAME_FRQ} select TIPO='FRANQUICIA',rtrim(ltrim(ISNULL(substring(l.local_nombre,0,20),'VACIO'))) AS 'NOMBRE_DE_LOCAL', rtrim(ltrim(ISNULL(p.LISP_CODIGO,'VACIO'))) AS 'CODIGO_DE_LOCAL',rtrim(ltrim(ISNULL(p.ART_CODIGO,'VACIO'))) AS 'CODIGO_DE_ARTICULO',rtrim(ltrim(ISNULL(a.ART_DESCORTA,'VACIO'))) AS 'DESC_CORTA',rtrim(ltrim(ISNULL(a.ART_DESLARGA,'VACIO'))) AS 'DESC_LARGA',rtrim(ltrim(ISNULL(p.PRE_PRECIO,'VACIO'))) AS 'PRECIO',rtrim(ltrim(isnull(p.PRE_PRECIOUNIDAD,'VACIO'))) AS 'PRECIO_UNI',rtrim(ltrim(ISNULL(converT(varchar,p.PRE_FECCAM,3),'VACIO'))) AS 'ULTIMO_ENV',rtrim(ltrim(ISNULL(convert(varchar,p.dfecha_desde,3),'VACIO'))) AS 'DESDE',rtrim(ltrim(ISNULL(convert(varchar,p.dfecha_hasta,3),'VACIO'))) AS 'HASTA',rtrim(ltrim(ISNULL(a.ART_PADRE,'VACIO'))) AS 'RUBRO',rtrim(ltrim(ISNULL(a.tpr_codigo,'VACIO'))) AS 'ES_MENU' ,rtrim(ltrim(ISNULL(a.ART_ACTIVO,'VACIO'))) AS 'ACTIVO',rtrim(ltrim(ISNULL(a.art_comanda,'VACIO'))) AS 'SE_AGRANDA',rtrim(ltrim(ISNULL(a.ART_FACTURABLE,'VACIO'))) AS 'SE_FACTURA',rtrim(ltrim(ISNULL(a.ART_SEVENDE,'VACIO'))) AS 'SE_VENDE',rtrim(ltrim(isnull(a.ART_CALIDAD,'VACIO'))) AS 'SE_ENVIA_A_LOCAL',rtrim(ltrim(ISNULL(a.ART_ENMENU,'VACIO'))) AS 'EN_BOTONERA',rtrim(ltrim(ISNULL(a.ART_PMSOLO,'VACIO'))) AS 'JERARQUIA_EN_ZONA' from ${process.env.DB_NAME_FRQ}.dbo.precios p inner join ${process.env.DB_NAME_FRQ}.dbo.locales l on l.local_codigo=p.lisp_codigo inner join ${process.env.DB_NAME_FRQ}.dbo.articulos_E a on a.art_codigo=p.ART_CODIGO where a.art_descorta like '%@parametro%' and p.LISP_CODIGO like '%@parametro1%'`,
    db_space_prp:`use ${process.env.DB_NAME_PRP} select ltrim(rtrim(empresa)) as'empresa', ltrim(rtrim(local)) as 'local', rtrim(ltrim(SUBSTRING(local_nombre, 0, 18))) as nombre_local, rtrim(ltrim(PARAMETRO)) as 'parametro',concat(ltrim(rtrim(valor))/1000,' ','Gb') as 'valor', rtrim(ltrim(convert(varchar,fechatrans,103))) as 'fecha',rtrim(ltrim(SUBSTRING(EQUIPO, 0, 15))) as 'equipo',rtrim(ltrim(caja)) as 'nro_caja' from (select *, ROW_NUMBER() OVER ( PARTITION BY equipo, parametro, local    ORDER BY fechatrans DESC)  rango from hparamloc where parametro in( 'sql_dataspace') and REPLACE(valor, 'Gb', '')>=8000 and local not in ('PRU') and FECHATRANS > getdate()-10) hpl left join locales loc on loc.local_codigo = hpl.local collate SQL_Latin1_General_CP1_CI_AS where rango = 1 order by cast(replace(valor,' GB','') as int ) desc`,
    hd_space_prp: `use ${process.env.DB_NAME_PRP} select ltrim(rtrim(empresa)) as'empresa', ltrim(rtrim(local)) as 'local', rtrim(ltrim(SUBSTRING(local_nombre, 0, 20))) as nombre_local, rtrim(ltrim(PARAMETRO)) as 'parametro', rtrim(ltrim(valor)) as 'valor', rtrim(ltrim(convert(varchar,fechatrans,103))) as 'fecha', rtrim(ltrim(SUBSTRING(equipo, 0, 15))) as 'equipo',rtrim(ltrim(caja)) as 'nro_caja' from  (select *, ROW_NUMBER() OVER ( PARTITION BY equipo, parametro, local    ORDER BY fechatrans DESC)  rango from hparamloc  where parametro in( 'HD_space')  and local not in ('PRU') and FECHATRANS > dateadd(MONTH,-1,getdate())) hpl left join locales loc on loc.local_codigo = hpl.local  collate SQL_Latin1_General_CP1_CI_AS where rango = 1 and REPLACE(valor, 'Gb', '')<=10order by cast(replace(valor,' GB','') as int )`,
    Ventas_Mes_Corriente:`use ${process.env.DB_NAME_PRP} select top 25 e.PERI_CODIGO as 'Local', count(*) as 'Cant_ticket_Mes_Corriente',sum(t.VENT_IMPORTE) as 'Venta_Mes_Corriente' from ventas_e  e inner join ventas_t t on e.vene_numero = t.vene_numero  and  e.suc_codigo = t.SUC_CODIGO and e.cbtee_codigo=t.CBTEE_CODIGO and e.CBTEE_MODULO=t.CBTEE_MODULO and e.vtalon_codigo=t.vtalon_codigo where e.vene_fecha>=CONVERT(varchar,dateadd(d,-(day(getdate()-1)),getdate()),106) and e.vene_fecha<getdate()-1 and e.PERI_CODIGO!='2021' and t.VENT_CONCEPTO='TOTAL'group by  e.PERI_CODIGO ORDER BY [Venta_Mes_Corriente] desc `,
    promos:`use ${process.env.DB_NAME_PRP}; WITH UniqueRecords AS ( SELECT isnull(p.lisp_codigo,'No existe') as'local_pre' , e.pcu_codigo as 'codPromo', e.pcu_nombre as 'Promo', d.art_codigo as 'codArticulo', ISNULL(a.ART_DESCORTA, 'No existe') AS Descripcion, ISNULL(p.pre_precio,NULL) as Precio , d.pcu_cantidad as 'CantEnPromo', e.pcu_tipopromo as 'Tipo Promo', e.pcu_cantproddetalle as 'Items en promo', e.pcu_cantprodpromo as 'ProdEnPromo', e.pcu_mayora as 'Precio Promo',e.pcu_segmentos as 'Segmento', e.pcu_fdesde as 'Desde', e.pcu_fhasta as 'Hasta', ROW_NUMBER() OVER (PARTITION BY e.pcu_codigo ORDER BY d.art_codigo) AS row_num FROM promocuponera_e e INNER JOIN promocuponera_d d ON d.pcu_codigo = e.pcu_codigo LEFT JOIN ARTICULOS_E a ON a.ART_CODIGO = d.art_codigo LEFT JOIN precios p ON p.ART_CODIGO = d.art_codigo WHERE e.pcu_codigo = '@parametro' AND LISP_CODIGO ='@parametro1' ) SELECT [local_pre], [codPromo], [Promo], [codArticulo], Descripcion, Precio, CASE WHEN row_num = 1 THEN [CantEnPromo] ELSE NULL END AS [CantEnPromo], CASE WHEN row_num = 1 THEN [Tipo Promo] ELSE NULL END AS [Tipo Promo], CASE WHEN row_num = 1 THEN [Items en promo] ELSE NULL END AS [Items en promo], CASE WHEN row_num = 1 THEN [ProdEnPromo] ELSE NULL END AS [ProdEnPromo], CASE WHEN row_num = 1 THEN [Precio Promo]  ELSE NULL END AS [Precio Promo],Segmento, CASE WHEN row_num = 1 THEN [Desde] ELSE NULL END AS [Desde], CASE WHEN row_num = 1 THEN [Hasta] ELSE NULL END AS [Hasta] FROM UniqueRecords ORDER BY [codArticulo]`,    
    promos_frq:`use ${process.env.DB_NAME_FRQ}; WITH UniqueRecords AS ( SELECT isnull(p.lisp_codigo,'No existe') as'local_pre' , e.pcu_codigo as 'codPromo', e.pcu_nombre as 'Promo', d.art_codigo as 'codArticulo', ISNULL(a.ART_DESCORTA, 'No existe') AS Descripcion, ISNULL(p.pre_precio,NULL) as Precio , d.pcu_cantidad as 'CantEnPromo', e.pcu_tipopromo as 'Tipo Promo', e.pcu_cantproddetalle as 'Items en promo', e.pcu_cantprodpromo as 'ProdEnPromo', e.pcu_mayora as 'Precio Promo',e.pcu_segmentos as 'Segmento', e.pcu_fdesde as 'Desde', e.pcu_fhasta as 'Hasta', ROW_NUMBER() OVER (PARTITION BY e.pcu_codigo ORDER BY d.art_codigo) AS row_num FROM promocuponera_e e INNER JOIN promocuponera_d d ON d.pcu_codigo = e.pcu_codigo LEFT JOIN ARTICULOS_E a ON a.ART_CODIGO = d.art_codigo LEFT JOIN precios p ON p.ART_CODIGO = d.art_codigo WHERE e.pcu_codigo = '@parametro' AND LISP_CODIGO like '@parametro1' ) SELECT [local_pre], [codPromo], [Promo], [codArticulo], Descripcion, Precio, CASE WHEN row_num = 1 THEN [CantEnPromo] ELSE NULL END AS [CantEnPromo], CASE WHEN row_num = 1 THEN [Tipo Promo] ELSE NULL END AS [Tipo Promo], CASE WHEN row_num = 1 THEN [Items en promo] ELSE NULL END AS [Items en promo], CASE WHEN row_num = 1 THEN [ProdEnPromo] ELSE NULL END AS [ProdEnPromo], CASE WHEN row_num = 1 THEN [Precio Promo]  ELSE NULL END AS [Precio Promo],Segmento, CASE WHEN row_num = 1 THEN [Desde] ELSE NULL END AS [Desde], CASE WHEN row_num = 1 THEN [Hasta] ELSE NULL END AS [Hasta] FROM UniqueRecords ORDER BY [codArticulo]`,
    usuarios: `use ${process.env.DB_NAME_PRP} select usuario, clave from usuarios where usuario= '@parametro'`

}

